---
title: "Reproducible Research Course Project 1"
author: "Rockwell Mitchell"
date: "2024-10-03"
output: html_document
---
This assignment makes use of data from a personal activity monitoring device. This device collects data at 5 minute intervals through out the day. The data consists of two months of data from an anonymous individual collected during the months of October and November, 2012 and include the number of steps taken in 5 minute intervals each day.



### 1. Code for reading in the dataset and/or processing the data

The goal of 'readr' is to provide a fast and friendly way to read rectangular data (i.e. 'csv').
```{r}
library(readr)
```

Read the csv file into a data frame.
```{r message=FALSE, warning=FALSE}
activityRaw <- read_csv("C:/Users/rockw_000/Desktop/Coursera/repdata_data_activity/activity.csv")
```

Review the data to ensure functionality
```{r}
head(activityRaw)
```
After reviewing the dataset, we see that the "steps" column contains "NA" beginning on 1 October 2012.
```{r}
library(plyr)
count(activityRaw$steps == "NA")
```
Exactly 2,304 "NA" in the step column.



### 2. Histogram of the total number of steps taken each day

For this part of the assignment, the missing values will be ignored in the dataset. We'll do this by removing the NA values.
```{r}
activity <- na.omit(activityRaw, "steps")

head(activity)
```
Noticed with the NA removed, the data set begins on 2 October 2012.

To determine the total number of steps taken each day, we first need to group the data by day and then calculate the sum for each group. The aggregate function efficiently manages both tasks, producing a data frame as the final output.
```{r}
stepsSum <- aggregate(steps ~ date, activity, sum)

head(stepsSum)
```

Create a histogram plot using the data frame generated by the aggregate function to visualize the total number of steps taken for each day over the two-month period. This will provide a clear representation of daily activity levels, allowing for easy identification of trends and patterns in the data.
```{r}
hist(stepsSum$steps, breaks = 60, xlab = "Number of Steps", 
     main = "Total Number of Steps Taken / Day")
```



### 3. Calculate and report the mean and median total number of steps taken per day.

Next we generate the mean and median values by summarizing the total number of steps per day.
```{r}
summarySteps <- summarise(stepsSum, mean(stepsSum$steps), median(stepsSum$steps))
```

Here, we are just renaming the column names to accurately reflect meaning of the data.
```{r}
summarySteps <- rename(summarySteps,c("mean(stepsSum$steps)" = "Mean ", "median(stepsSum$steps)" = " Median"))

print(summarySteps)
```



### 4. Time series plot of the average number of steps taken.

Make a time series plot of the 5-minute interval on the x-axis and the average number of steps taken, averaged across all days on the y-axis. First we need to determine the average number of steps taken each day, we first need to group the data by interval and then calculate the mean for each group.
```{r}
meanSteps <- aggregate(steps ~ interval, activity, mean)

head(meanSteps)
```

Here we generate a time series line plot on the 5 minute interval by the average number of steps taken.
```{r warning=FALSE}
library(ggplot2)

qplot(interval, steps, data = meanSteps, geom = c("line"))+
        labs(title = "Average number of Step per Day", 
             y = "Average Number of steps", 
             x = "5 Minute Intervals")
```

### 5. The 5-minute interval that, on average, contains the maximum number of steps

Here we'll extract the interval that has the maximum number of steps on average. The grep function search for matches to argument pattern within each element of a character vector. So we are pulling the interval with the maximum number of average steps from the "meanSteps" dataframe and displaying it and the corresponding number of steps. 

```{r}
meanSteps[grep(max(meanSteps$steps), meanSteps$steps),]
```

### 6. Code to describe and show a strategy for imputing missing data.

Recall the raw data has 2,304 NAs in the step column for 1 October 2012. Including the NAs, the raw data has 17,568 observations.  

```{r}
table(is.na(activityRaw$steps))
```
2,304 rows with NA and 15,264 rows with numbers of steps is 17,568 observations.

First, we'll safeguard the raw data by creating a copy in a new data frame. Next, we'll implement a for loop that fills in the average number of steps for each 5-minute interval, replacing any NA values with the corresponding step counts. This ensures a more complete dataset for analysis.
```{r}
imputedActivity <- activityRaw

for(x in 1:17568){ 
        if(is.na(imputedActivity[x, 1]) == TRUE){
            imputedActivity[x,1] <- meanSteps[meanSteps$interval %in% imputedActivity[x,3],2]
}
        }
       
head(imputedActivity)
```
Here we can see the data set for 1 October 2012 in filled with the mean number of steps for each interval.


### 7.Histogram of the total number of steps taken each day after missing values are imputed
Here we are using the similar steps as before but with the missing values added to acquire the total number of steps taken each day.
```{r}
imputStepsSum <- aggregate(steps ~ date, imputedActivity, sum)

head(imputStepsSum)

hist(imputStepsSum$steps, breaks = 60, xlab = "Number of Steps", 
     main = "Total Number of Steps Taken / Day")
```

Next we generate the mean and median values by summarizing the total number of steps per day.
```{r}
imputSummarySteps <- summarise(imputStepsSum, mean(imputStepsSum$steps), median(imputStepsSum$steps))

imputSummarySteps <- rename(imputSummarySteps,c("mean(imputStepsSum$steps)" = "Mean ", "median(imputStepsSum$steps)" = " Median"))

print(imputSummarySteps)
```
These values does not differ much from the estimates from the first part of the assignment. The impact of imputing missing data on the estimates of the total daily number of steps was negligible.


### 8. Panel plot comparing the average number of steps taken per 5-minute interval across weekdays and weekends

Here, we copied the data set with the full date to a new data set to protect the integrity of the original. We also use weekdays() on the date column to give us the day of the week in a new column. We also created a 5th column to determine if the day of the week in column 4 is a weekday or a weekend.
```{r}
activityDays <- imputedActivity

activityDays$days <- weekdays(activityDays$date)

activityDays$weekdy_weeknd <- as.character(rep(0, times =17568))

for(x in 1:17568) {
        if(activityDays[x,4] %in% c("Saturday", "Sunday")) {
                activityDays[x,5] <- "Weekend"
        } else {
                activityDays[x,5] <- "Weekday"
        }
}
```

Here we see a snippet of the dataframe. 
```{r}
head(activityDays)
```

The final step is to generate a panel plot containing a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all weekday days or weekend days (y-axis). 
```{r}
library(lattice)

xyplot(steps ~ interval | weekdy_weeknd, data = activityDays, layout = c(1,2), type = "l")

```